# ============================================================================
# GPU Module CMakeLists (STATIC LIBRARY - includes cpp files)
# src/GPU/CMakeLists.txt
# ============================================================================
# –ù–ê–ó–ù–ê–ß–ï–ù–ò–ï: GPU –º–æ–¥—É–ª—å (GeneratorGPU, AntennaFFT)
# ============================================================================

message(STATUS "")
message(STATUS "üîß Processing: src/GPU/")
message(STATUS "")

# ============================================================================
# GPU –ú–û–î–£–õ–¨ - STATIC LIBRARY (—Å cpp —Ñ–∞–π–ª–∞–º–∏)
# ============================================================================

# –ò—Å—Ö–æ–¥–Ω—ã–µ —Ñ–∞–π–ª—ã
set(GPU_SOURCES
    generator_gpu_new.cpp
    antenna_fft_proc_max.cpp
    fractional_delay_processor.cpp
)

# –°–æ–∑–¥–∞–µ–º —Å—Ç–∞—Ç–∏—á–µ—Å–∫—É—é –±–∏–±–ª–∏–æ—Ç–µ–∫—É
add_library(lfm_gpu STATIC ${GPU_SOURCES})

message(STATUS "‚úÖ Created library: lfm_gpu (STATIC)")
message(STATUS "   Sources: ${GPU_SOURCES}")

# ============================================================================
# –ü–û–î–ö–õ–Æ–ß–ï–ù–ò–ï INCLUDE –î–ò–†–ï–ö–¢–û–†–ò–ô
# ============================================================================

target_include_directories(lfm_gpu PUBLIC
    ${CMAKE_SOURCE_DIR}/include
    ${CMAKE_SOURCE_DIR}/include/GPU
    ${CMAKE_SOURCE_DIR}/include/ManagerOpenCL
    ${CMAKE_SOURCE_DIR}/include/interface
    ${CMAKE_SOURCE_DIR}/clFFT/include        # –õ–æ–∫–∞–ª—å–Ω—ã–π clFFT —Å inline —Ñ—É–Ω–∫—Ü–∏—è–º–∏
    ${OpenCL_INCLUDE_DIRS}
)

# ============================================================================
# –õ–ò–ù–ö–û–í–ö–ê –ó–ê–í–ò–°–ò–ú–û–°–¢–ï–ô
# ============================================================================

target_link_libraries(lfm_gpu PUBLIC
    lfm_opencl_manager
    OpenCL::OpenCL
)

if(CLFFT_FOUND)
    target_link_libraries(lfm_gpu PUBLIC "${CLFFT_LIB}")
    target_include_directories(lfm_gpu PUBLIC "${CLFFT_INCLUDE_DIR}")
endif()

# ============================================================================
# COMPILE DEFINITIONS
# ============================================================================

target_compile_definitions(lfm_gpu PUBLIC
    GPU_MODULE_ENABLED=1
    OPENCL_ENABLED=1
    CL_TARGET_OPENCL_VERSION=300
)

message(STATUS "‚úÖ GPU module configured (STATIC library)")
message(STATUS "")
