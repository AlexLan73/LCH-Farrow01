# ============================================================================
# Test Module CMakeLists
# src/Test/CMakeLists.txt
# ============================================================================
# –ù–ê–ó–ù–ê–ß–ï–ù–ò–ï: –ö–æ–º–ø–∏–ª—è—Ü–∏—è —Ç–µ—Å—Ç–æ–≤ –∏ –ø—Ä–∏–º–µ—Ä–æ–≤
# ============================================================================

message(STATUS "")
message(STATUS "üß™ Processing: src/Test/")
message(STATUS "")

# ============================================================================
# –ò–°–•–û–î–ù–´–ï –§–ê–ô–õ–´ –¢–ï–°–¢–û–í
# ============================================================================

set(TEST_SOURCES
    test_antenna_fft_proc_max.cpp
    test_signal_sinusoids.cpp
)

# ============================================================================
# –ó–ê–ì–û–õ–û–í–û–ß–ù–´–ï –§–ê–ô–õ–´ –¢–ï–°–¢–û–í
# ============================================================================

set(TEST_HEADERS
    ${CMAKE_SOURCE_DIR}/include/Test/example_signal_combined_delays.hpp
    ${CMAKE_SOURCE_DIR}/include/Test/example_usage.hpp
    ${CMAKE_SOURCE_DIR}/include/Test/test_antenna_fft_proc_max.hpp
    ${CMAKE_SOURCE_DIR}/include/Test/test_hybrid_buffer.hpp
    ${CMAKE_SOURCE_DIR}/include/Test/test_signal_sinusoids.hpp
)

# ============================================================================
# –°–û–ó–î–ê–ù–ò–ï –û–ë–™–ï–ö–¢–ù–û–ô –ë–ò–ë–õ–ò–û–¢–ï–ö–ò –¢–ï–°–¢–û–í
# ============================================================================

add_library(lfm_tests OBJECT
    ${TEST_SOURCES}
    ${TEST_HEADERS}
)

message(STATUS "‚úÖ Created test library: lfm_tests")

# ============================================================================
# –ü–û–î–ö–õ–Æ–ß–ï–ù–ò–ï INCLUDE –î–ò–†–ï–ö–¢–û–†–ò–ô
# ============================================================================

target_include_directories(lfm_tests PRIVATE
    ${CMAKE_SOURCE_DIR}/include
    ${CMAKE_SOURCE_DIR}/include/Test
    ${CMAKE_SOURCE_DIR}/include/GPU
    ${CMAKE_SOURCE_DIR}/include/ManagerOpenCL
    ${CMAKE_SOURCE_DIR}/include/interface
)

# ============================================================================
# –ó–ê–í–ò–°–ò–ú–û–°–¢–ò
# ============================================================================

if(OPENCL_ENABLED)
    target_link_libraries(lfm_tests PRIVATE
        lfm_opencl_manager
        OpenCL::OpenCL
    )
    
    if(CLFFT_FOUND)
        target_link_libraries(lfm_tests PRIVATE "${CLFFT_LIB}")
    endif()
endif()

# ============================================================================
# COMPILER FLAGS
# ============================================================================

if(MSVC)
    target_compile_options(lfm_tests PRIVATE /arch:AVX2)
else()
    target_compile_options(lfm_tests PRIVATE -march=native)
endif()

# ============================================================================
# COMPILE DEFINITIONS
# ============================================================================

if(OPENCL_ENABLED)
    target_compile_definitions(lfm_tests PRIVATE OPENCL_ENABLED=1)
endif()

message(STATUS "‚úÖ Test module configured")
message(STATUS "")
