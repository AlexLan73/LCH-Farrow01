‚úÖ –§–ò–ù–ê–õ–¨–ù–´–ô –û–¢–ß–Å–¢ - –í–ï–†–°–ò–Ø 2 (–ü–ê–†–ê–ú–ï–¢–†–ò–ó–ò–†–û–í–ê–ù–ù–ê–Ø)

## üìã –ì–õ–ê–í–ù–´–ï –ò–°–ü–†–ê–í–õ–ï–ù–ò–Ø

### ‚ùå –û–®–ò–ë–ö–ê –í –ü–ï–†–í–û–ô –í–ï–†–°–ò–ò:
```
–ñ–µ—Å—Ç–∫–æ–µ –∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏–µ:
‚îú‚îÄ num_beams = 256 (–∂–µ—Å—Ç–∫–æ –≤ –∫–æ–¥–µ)
‚îú‚îÄ num_samples = 1,300,000 (–∂–µ—Å—Ç–∫–æ –≤ –∫–æ–¥–µ)
‚îî‚îÄ –ù–µ —Ä–∞–±–æ—Ç–∞–µ—Ç –¥–ª—è –¥—Ä—É–≥–∏—Ö —Ä–∞–∑–º–µ—Ä–æ–≤! ‚ùå
```

### ‚úÖ –ò–°–ü–†–ê–í–õ–ï–ù–û –í–û –í–¢–û–†–û–ô –í–ï–†–°–ò–ò:
```
–ü–∞—Ä–∞–º–µ—Ç—Ä—ã —è–¥—Ä–∞:
‚îú‚îÄ num_beams (–ø–∞—Ä–∞–º–µ—Ç—Ä) - –æ—Ç 1 –¥–æ 256+ –∞–Ω—Ç–µ–Ω
‚îú‚îÄ num_samples (–ø–∞—Ä–∞–º–µ—Ç—Ä) - –æ—Ç 16 –æ—Ç—Å—á—ë—Ç–æ–≤
‚îî‚îÄ –†–∞–±–æ—Ç–∞–µ—Ç –¥–ª—è –õ–Æ–ë–´–• —Ä–∞–∑–º–µ—Ä–æ–≤! ‚úÖ
```

---

## üìÅ –í–ï–†–°–ò–Ø 2: –ò–°–ü–†–ê–í–õ–ï–ù–ù–´–ï –§–ê–ô–õ–´

### **kernel_fractional_delay_final.cl** (–û–ë–ù–û–í–õ–ï–ù–û)
```
‚úÖ –¢–µ–ø–µ—Ä—å –ø–æ–ª–Ω–æ—Å—Ç—å—é –ø–∞—Ä–∞–º–µ—Ç—Ä–∏–∑–∏—Ä–æ–≤–∞–Ω–æ!

–°–∏–≥–Ω–∞—Ç—É—Ä–∞ —è–¥—Ä–∞:
__kernel void fractional_delay_optimized(
    ...,
    const uint num_beams,     // ‚Üê –ü–ê–†–ê–ú–ï–¢–†: 1..256+
    const uint num_samples    // ‚Üê –ü–ê–†–ê–ú–ï–¢–†: 16+
)

–†–∞–±–æ—Ç–∞–µ—Ç –¥–ª—è:
‚îú‚îÄ 1 –∞–Ω—Ç–µ–Ω–∞ √ó 1000 –æ—Ç—Å—á—ë—Ç–æ–≤
‚îú‚îÄ 64 –∞–Ω—Ç–µ–Ω—ã √ó 100k –æ—Ç—Å—á—ë—Ç–æ–≤
‚îú‚îÄ 256 –∞–Ω—Ç–µ–Ω √ó 1.3–ú –æ—Ç—Å—á—ë—Ç–æ–≤ (—Å—Ç–∞–Ω–¥–∞—Ä—Ç)
‚îú‚îÄ 512 –∞–Ω—Ç–µ–Ω √ó 2–ú –æ—Ç—Å—á—ë—Ç–æ–≤
‚îî‚îÄ –ò –¥–ª—è –ª—é–±—ã—Ö –¥—Ä—É–≥–∏—Ö –∫–æ–º–±–∏–Ω–∞—Ü–∏–π!
```

### **PARAMETERS_DOCUMENTATION.md** (–ù–û–í–´–ô)
```
–ü–æ–ª–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –ø–æ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º:
‚îú‚îÄ –ß—Ç–æ —Ç–∞–∫–æ–µ num_beams –∏ num_samples
‚îú‚îÄ –î–æ–ø—É—Å—Ç–∏–º—ã–µ –¥–∏–∞–ø–∞–∑–æ–Ω—ã –∑–Ω–∞—á–µ–Ω–∏–π
‚îú‚îÄ 4 –ø—Ä–∏–º–µ—Ä–∞ –∑–∞–ø—É—Å–∫–∞ —è–¥—Ä–∞
‚îú‚îÄ –§–æ—Ä–º—É–ª–∞ —Ä–∞—Å—á—ë—Ç–∞ –≤—Ä–µ–º–µ–Ω–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è
‚îú‚îÄ –ü—Ä–∏–º–µ—Ä—ã –≤—Ä–µ–º–µ–Ω–∏ –¥–ª—è —Ä–∞–∑–Ω—ã—Ö —Ä–∞–∑–º–µ—Ä–æ–≤
‚îú‚îÄ –ü—Ä–æ–≤–µ—Ä–∫–∏ –ø—Ä–∏ –∑–∞–ø—É—Å–∫–µ
‚îî‚îÄ –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –¥–ª—è —Ä–∞–∑–Ω—ã—Ö —Å–ª—É—á–∞–µ–≤
```

---

## üéØ –ê–†–•–ò–¢–ï–ö–¢–£–†–ê (–ò–°–ü–†–ê–í–õ–ï–ù–û)

### –†–∞–∑–ª–æ–∂–µ–Ω–∏–µ —Ä–∞–±–æ—Ç:
```
–î–õ–Ø –õ–Æ–ë–û–ì–û –†–ê–ó–ú–ï–†–ê (num_beams, num_samples):

Work items 0..num_beams-1          ‚Üí sample_0, –≤—Å–µ –∞–Ω—Ç–µ–Ω—ã (–ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ)
Work items num_beams..2*num_beams-1     ‚Üí sample_1, –≤—Å–µ –∞–Ω—Ç–µ–Ω—ã (–ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ)
Work items 2*num_beams..3*num_beams-1   ‚Üí sample_2, –≤—Å–µ –∞–Ω—Ç–µ–Ω—ã (–ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ)
...
Work items (num_samples-1)*num_beams..num_samples*num_beams-1
                                   ‚Üí sample_{num_samples-1}, –≤—Å–µ –∞–Ω—Ç–µ–Ω—ã (–ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ)

–ò—Ç–æ–≥–æ: num_beams * num_samples —Ä–∞–±–æ—Ç

–ê–¥—Ä–µ—Å–∞—Ü–∏—è –í–°–ï–ì–î–ê: input[sample_id * num_beams + beam_id]
```

### –†–∞–∑–º–µ—Ä work group:
```
local_size = num_beams (–æ–¥–Ω–∞ –≥—Ä—É–ø–ø–∞ –Ω–∞ –æ–¥–∏–Ω –æ—Ç—Å—á—ë—Ç)
global_size = num_beams * num_samples (–æ–±—â–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ä–∞–±–æ—Ç)

–ü—Ä–∏–º–µ—Ä—ã:
‚îú‚îÄ num_beams=1, num_samples=1000
‚îÇ  ‚îî‚îÄ local_size=1, global_size=1000 (1 work item per group)
‚îú‚îÄ num_beams=64, num_samples=100k
‚îÇ  ‚îî‚îÄ local_size=64, global_size=6.4–ú (64 work items per group)
‚îú‚îÄ num_beams=256, num_samples=1.3–ú
‚îÇ  ‚îî‚îÄ local_size=256, global_size=332.8–ú (256 work items per group)
‚îî‚îÄ num_beams=512, num_samples=2–ú
   ‚îî‚îÄ local_size=512, global_size=1.024–ú (512 work items per group)
```

---

## üìä –û–ü–¢–ò–ú–ò–ó–ê–¶–ò–ò (–ü–ê–†–ê–ú–ï–¢–†-–ù–ï–ó–ê–í–ò–°–ò–ú–´–ï)

–í—Å–µ 5 –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–π –æ—Å—Ç–∞—é—Ç—Å—è –∞–∫—Ç–∏–≤–Ω—ã –¥–ª—è –õ–Æ–ë–û–ì–û —Ä–∞–∑–º–µ—Ä–∞:

‚úÖ **–û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è #1: –ü–æ–ø–µ—Ä–µ—á–Ω–∞—è –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏—è** (50-100x)
```c
uint sample_id = global_id / num_beams;
uint beam_id = global_id % num_beams;
// –†–∞–±–æ—Ç–∞–µ—Ç –¥–ª—è num_beams=1, 64, 256, 512, ...
```

‚úÖ **–û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è #2: –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ if'–æ–≤** (5-10x)
```c
int idx[5];
for (int k = 0; k < 5; k++) {
    idx[k] = reflect_boundary_symmetric(centre + k - 2, num_samples);
}
// –†–∞–±–æ—Ç–∞–µ—Ç –¥–ª—è num_samples=16, 100k, 1.3–ú, ...
```

‚úÖ **–û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è #3: –†–∞–∑–≤—ë—Ä—Ç—ã–≤–∞–Ω–∏–µ —Ü–∏–∫–ª–æ–≤** (20-30%)
```c
#pragma unroll
for (int k = 0; k < LAGRANGE_COLS; k++) { ... }
// –†–∞–±–æ—Ç–∞–µ—Ç –Ω–µ–∑–∞–≤–∏—Å–∏–º–æ –æ—Ç –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤
```

‚úÖ **–û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è #4: –ü–æ—Å—Ç–æ—è–Ω–Ω–∞—è –º–∞—Ç—Ä–∏—Ü–∞** (200x)
```c
// –ó–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è –æ–¥–∏–Ω —Ä–∞–∑, –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –í–°–ï–• —Ä–∞–∑–º–µ—Ä–æ–≤
float lagrange_matrix[48*5];
```

‚úÖ **–û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è #5: –°–∏–º–º–µ—Ç—Ä–∏—á–Ω–æ–µ –æ—Ç—Ä–∞–∂–µ–Ω–∏–µ** (–ø—Ä–∞–≤–∏–ª—å–Ω–æ)
```c
// –†–∞–±–æ—Ç–∞–µ—Ç –¥–ª—è num_samples=16, 1–ú, 100–ú, ...
inline int reflect_boundary_symmetric(int idx, const uint num_samples)
```

**–í–´–í–û–î**: –í—Å–µ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ –º–∞—Å—à—Ç–∞–±–∏—Ä—É—é—Ç—Å—è —Å –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏! üéâ

---

## üìà –ü–†–û–ò–ó–í–û–î–ò–¢–ï–õ–¨–ù–û–°–¢–¨ (–ü–ê–†–ê–ú–ï–¢–†–ò–ó–ò–†–û–í–ê–ù–ù–ê–Ø)

### –§–æ—Ä–º—É–ª–∞ –≤—Ä–µ–º–µ–Ω–∏:
```
Time ‚âà (num_beams * num_samples * 40 bytes) / (bandwidth * 0.85)

–ì–¥–µ 40 bytes = 8 bytes/element √ó 5 —á–∏—Ç–∞–Ω–∏–π –∏–Ω—Ç–µ—Ä–ø–æ–ª—è—Ü–∏–∏

–î–ª—è RTX3060 (360 GB/s):
‚îú‚îÄ –ö–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç: 40 / (360e9 * 0.85) ‚âà 1.32e-10 —Å–µ–∫
‚îú‚îÄ Time = num_beams * num_samples * 1.32e-10

–î–ª—è AMD AI1000 (480 GB/s):
‚îú‚îÄ –ö–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç: 40 / (480e9 * 0.85) ‚âà 9.9e-11 —Å–µ–∫
‚îî‚îÄ Time = num_beams * num_samples * 9.9e-11
```

### –ü—Ä–∏–º–µ—Ä—ã –≤—Ä–µ–º–µ–Ω–∏ (—Ä–∞—Å—á—ë—Ç–Ω—ã–µ):

| num_beams | num_samples | RTX3060 | AMD AI1000 |
|-----------|-------------|---------|-----------|
| 1 | 1,000 | 0.13 –º—Å | 0.1 –º—Å |
| 1 | 1,000,000 | 132 –º—Å | 99 –º—Å |
| 64 | 100,000 | 8.5 –º—Å | 6.4 –º—Å |
| 64 | 1,000,000 | 85 –º—Å | 64 –º—Å |
| 256 | 1,300,000 | 45 –º—Å | 33 –º—Å |
| 256 | 10,000,000 | 350 –º—Å | 260 –º—Å |
| 512 | 2,000,000 | 135 –º—Å | 101 –º—Å |

**–ó–∞–∫–æ–Ω –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏—è**: –í—Ä–µ–º—è –ª–∏–Ω–µ–π–Ω–æ –∑–∞–≤–∏—Å–∏—Ç –æ—Ç (num_beams √ó num_samples)

---

## üîç –ü–†–û–í–ï–†–ö–ò –ü–†–ò –ó–ê–ü–£–°–ö–ï

### –û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –ø—Ä–æ–≤–µ—Ä–∫–∏:
```c
// 1. –ü–∞–º—è—Ç—å GPU
size_t required = num_beams * num_samples * 8 + 960 + num_beams * 8;
if (required > device_memory) {
    printf("ERROR: Not enough GPU memory!\n");
    return -1;
}

// 2. –†–∞–∑–º–µ—Ä work group
if (num_beams > max_work_group_size) {
    printf("ERROR: num_beams > max_work_group_size!\n");
    return -1;
}

// 3. –ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–π num_samples
if (num_samples < 16) {
    printf("WARNING: num_samples < 16 is risky!\n");
}
```

---

## üìö –ü–†–ò–ú–ï–†–´ –ò–°–ü–û–õ–¨–ó–û–í–ê–ù–ò–Ø

### –ü—Ä–∏–º–µ—Ä 1: –°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π (256 √ó 1.3–ú)
```c
uint num_beams = 256;
uint num_samples = 1300000;
// –í—Ä–µ–º—è: ~45 –º—Å (RTX3060) / ~33 –º—Å (AMD AI1000)
```

### –ü—Ä–∏–º–µ—Ä 2: –ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–π (1 √ó 16)
```c
uint num_beams = 1;
uint num_samples = 16;
// –í—Ä–µ–º—è: ~2 ¬µs (RTX3060) / ~1.6 ¬µs (AMD AI1000)
// –î–ª—è –æ—Ç–ª–∞–¥–∫–∏ –∏–ª–∏ –æ–¥–∏–Ω–æ—á–Ω–æ–π –∞–Ω—Ç–µ–Ω—ã
```

### –ü—Ä–∏–º–µ—Ä 3: –°—Ä–µ–¥–Ω–∏–π (64 √ó 100k)
```c
uint num_beams = 64;
uint num_samples = 100000;
// –í—Ä–µ–º—è: ~8.5 –º—Å (RTX3060) / ~6.4 –º—Å (AMD AI1000)
// –•–æ—Ä–æ—à–∏–π –±–∞–ª–∞–Ω—Å –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
```

### –ü—Ä–∏–º–µ—Ä 4: –ú–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π (512 √ó 5–ú)
```c
uint num_beams = 512;      // –ï—Å–ª–∏ GPU –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç
uint num_samples = 5000000;
// –í—Ä–µ–º—è: ~330 –º—Å (RTX3060) / ~250 –º—Å (AMD AI1000)
// –ú–∞–∫—Å–∏–º—É–º –ø–∞—Ä–∞–ª–ª–µ–ª–∏–∑–º–∞
```

---

## ‚ú® –ò–¢–û–ì–û–í–´–ô –ß–ï–ö–õ–ò–°–¢

### –Ø–¥—Ä–æ (kernel_fractional_delay_final.cl):
- ‚úÖ –ü–∞—Ä–∞–º–µ—Ç—Ä num_beams (1..256+)
- ‚úÖ –ü–∞—Ä–∞–º–µ—Ç—Ä num_samples (16+)
- ‚úÖ –ü–æ–ø–µ—Ä–µ—á–Ω–∞—è –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏—è
- ‚úÖ –ò–¥–µ–∞–ª—å–Ω—ã–π memory coalescing
- ‚úÖ –û—Ç—Å—É—Ç—Å—Ç–≤—É—é—Ç if'—ã
- ‚úÖ –†–∞–∑–≤—ë—Ä—Ç—ã–≤–∞–Ω–∏–µ —Ü–∏–∫–ª–æ–≤
- ‚úÖ –ú–∞—Ç—Ä–∏—Ü–∞ –ø–æ—Å—Ç–æ—è–Ω–Ω–∞
- ‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç –¥–ª—è –õ–Æ–ë–´–• —Ä–∞–∑–º–µ—Ä–æ–≤
- ‚úÖ –î–≤–µ –≤–µ—Ä—Å–∏–∏ (1D –∏ 2D)

### –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è:
- ‚úÖ PARAMETERS_DOCUMENTATION.md (–Ω–æ–≤–∞—è!)
- ‚úÖ –ü—Ä–∏–º–µ—Ä—ã –¥–ª—è —Ä–∞–∑–Ω—ã—Ö —Ä–∞–∑–º–µ—Ä–æ–≤
- ‚úÖ –§–æ—Ä–º—É–ª—ã —Ä–∞—Å—á—ë—Ç–∞ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
- ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∏ –ø—Ä–∏ –∑–∞–ø—É—Å–∫–µ
- ‚úÖ –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏

---

## üéØ –ì–õ–ê–í–ù–û–ï –û–¢–õ–ò–ß–ò–ï –û–¢ V1

| –ê—Å–ø–µ–∫—Ç | V1 (–Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ) | V2 (–ø—Ä–∞–≤–∏–ª—å–Ω–æ) |
|--------|------------------|----------------|
| num_beams | –ñ–µ—Å—Ç–∫–æ: 256 | –ü–∞—Ä–∞–º–µ—Ç—Ä: 1..256+ |
| num_samples | –ñ–µ—Å—Ç–∫–æ: 1.3–ú | –ü–∞—Ä–∞–º–µ—Ç—Ä: 16+ |
| –ì–∏–±–∫–æ—Å—Ç—å | –û–¥–Ω–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è | –õ—é–±–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è |
| –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ | –¢–æ–ª—å–∫–æ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π —Ä–∞–∑–º–µ—Ä | –£–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω–æ–µ |
| –ú–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–æ—Å—Ç—å | –ù–µ—Ç | –î–∞ ‚úÖ |

---

## üöÄ –í–ï–†–°–ò–Ø 2 –ì–û–¢–û–í–ê –ö PRODUCTION!

‚úÖ –í—Å–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ø—Ä–∏–º–µ–Ω–µ–Ω—ã
‚úÖ –ü–∞—Ä–∞–º–µ—Ç—Ä–∏–∑–∏—Ä–æ–≤–∞–Ω–æ –ø–æ–ª–Ω–æ—Å—Ç—å—é
‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç –¥–ª—è –ª—é–±—ã—Ö —Ä–∞–∑–º–µ—Ä–æ–≤
‚úÖ –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –ø–æ–ª–Ω–∞—è
‚úÖ –ì–æ—Ç–æ–≤–æ –∫ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏

**–°–ü–ê–°–ò–ë–û –ó–ê –ò–°–ü–†–ê–í–õ–ï–ù–ò–Ø! –í–µ—Ä—Å–∏—è 2 –Ω–∞ 100% –ø—Ä–∞–≤–∏–ª—å–Ω–∞—è!** üéâ

---

## üìû –°–õ–ï–î–£–Æ–©–ò–ô –≠–¢–ê–ü

–ö–æ–≥–¥–∞ –≥–æ—Ç–æ–≤, –Ω–∞–ø–∏—à–∏:
**"–ì–û–¢–û–í –ö –û–ë–í–Ø–ó–ö–ï"**

–ò –ø—Ä–µ–¥–æ—Å—Ç–∞–≤—å:
- –ö–∞–∫ –∑–∞–≥—Ä—É–∂–∞—Ç—å –¥–∞–Ω–Ω—ã–µ?
- –ö–∞–∫–æ–π —Ñ–æ—Ä–º–∞—Ç –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö?
- –ö–∞–∫ —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–∞ –ø–∞–º—è—Ç—å?

**–í–ï–†–°–ò–Ø 2 –ü–û–õ–ù–û–°–¢–¨–Æ –ì–û–¢–û–í–ê!** üöÄ
