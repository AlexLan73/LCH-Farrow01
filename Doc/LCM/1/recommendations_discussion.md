üí¨ –û–ë–°–£–ñ–î–ï–ù–ò–ï: –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –ø—Ä–æ–±–ª–µ–º—ã –∏ –ø—É—Ç–∏ —Ä–µ—à–µ–Ω–∏—è

## üéØ –ì–õ–ê–í–ù–ê–Ø –ü–†–û–ë–õ–ï–ú–ê

–¢–≤–æ–π —Ç–µ–∫—É—â–∏–π kernel **–ø—Ä–∞–≤–∏–ª—å–Ω–æ –ú–ê–¢–ï–ú–ê–¢–ò–ß–ï–°–ö–ò**, –Ω–æ **–Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ –ê–†–•–ò–¢–ï–ö–¢–£–†–ù–û** –¥–ª—è GPU!

### –°–∏—Ç—É–∞—Ü–∏—è:
```
–¢–µ–∫—É—â–µ–µ:    [antenna_0: sample_0, sample_1, ..., sample_N]
            [antenna_1: sample_0, sample_1, ..., sample_N]
            ...

–í–ú–ï–°–¢–û:     [all_antennas: sample_0 in parallel]
            [all_antennas: sample_1 in parallel]
            ...
```

**–ü–æ—Å–ª–µ–¥—Å—Ç–≤–∏–µ**: Memory bandwidth ~10% –≤–º–µ—Å—Ç–æ 80%!

---

## üî¥ –ü–†–û–ë–õ–ï–ú–ê #1: –û–†–ì–ê–ù–ò–ó–ê–¶–ò–Ø –î–ê–ù–ù–´–•

### –¢–í –¢–ï–ö–£–©–ï–ï (–ù–ï–ü–†–ê–í–ò–õ–¨–ù–û)

```c
uint beam_id = global_id / num_samples;      // 0 ‚Üí beam=0
uint sample_id = global_id % num_samples;    // 1..1.3–ú ‚Üí samples
```

**–≠—Ç–æ –æ–∑–Ω–∞—á–∞–µ—Ç**:
- Work items 0..1.3–ú –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—é—Ç antenna #0 –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ
- Work items 1.3–ú..2.6–ú –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—é—Ç antenna #1 –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ
- **GPU –Ω–µ –º–æ–∂–µ—Ç –≤—ã–ø–æ–ª–Ω—è—Ç—å –∏—Ö –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ**

### –ü–†–ê–í–ò–õ–¨–ù–û–ï (–ü–û–ü–ï–†–ï–ß–ù–û–ï)

```c
uint sample_id = global_id / num_beams;      // [0,255] ‚Üí beam ID
uint beam_id = global_id % num_beams;        // [0, 1.3–ú) ‚Üí sample ID
```

**–≠—Ç–æ –æ–∑–Ω–∞—á–∞–µ—Ç**:
- Work items 0..255 –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—é—Ç sample_0 –≤—Å–µ—Ö –∞–Ω—Ç–µ–Ω –ü–ê–†–ê–õ–õ–ï–õ–¨–ù–û
- Work items 256..511 –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—é—Ç sample_1 –≤—Å–µ—Ö –∞–Ω—Ç–µ–Ω –ü–ê–†–ê–õ–õ–ï–õ–¨–ù–û
- **GPU –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ —Ä–∞—Å–ø–∞—Ä–∞–ª–ª–µ–ª–∏–≤–∞–µ—Ç —Ä–∞–±–æ—Ç—É!**

### –í–∏–∑—É–∞–ª—å–Ω–æ:

```
–ù–ï–ü–†–ê–í–ò–õ–¨–ù–û (—Ç–µ–∫—É—â–µ–µ):
‚îú‚îÄ Work 0    ‚Üí beam=0, sample=0  (antenna 0, –æ—Ç—Å—á—ë—Ç 0)
‚îú‚îÄ Work 1    ‚Üí beam=0, sample=1  (antenna 0, –æ—Ç—Å—á—ë—Ç 1)
‚îú‚îÄ Work 2    ‚Üí beam=0, sample=2  (antenna 0, –æ—Ç—Å—á—ë—Ç 2)
‚îú‚îÄ ...
‚îú‚îÄ Work 1.3–ú ‚Üí beam=1, sample=0  (antenna 1, –æ—Ç—Å—á—ë—Ç 0)
‚îú‚îÄ Work 1.3–ú+1 ‚Üí beam=1, sample=1  (antenna 1, –æ—Ç—Å—á—ë—Ç 1)

–ü–†–ê–í–ò–õ–¨–ù–û (–ø–æ–ø–µ—Ä–µ—á–Ω–æ–µ):
‚îú‚îÄ Work 0    ‚Üí sample=0, beam=0   (–æ—Ç—Å—á—ë—Ç 0, antenna 0)
‚îú‚îÄ Work 1    ‚Üí sample=0, beam=1   (–æ—Ç—Å—á—ë—Ç 0, antenna 1)
‚îú‚îÄ Work 2    ‚Üí sample=0, beam=2   (–æ—Ç—Å—á—ë—Ç 0, antenna 2)
‚îú‚îÄ ...
‚îú‚îÄ Work 255  ‚Üí sample=0, beam=255 (–æ—Ç—Å—á—ë—Ç 0, antenna 255)
‚îú‚îÄ Work 256  ‚Üí sample=1, beam=0   (–æ—Ç—Å—á—ë—Ç 1, antenna 0)
‚îú‚îÄ Work 257  ‚Üí sample=1, beam=1   (–æ—Ç—Å—á—ë—Ç 1, antenna 1)
```

**GPU –º–æ–∂–µ—Ç –∑–∞–ø—É—Å—Ç–∏—Ç—å —Ä–∞–±–æ—Ç—ã 0-255 –Ω–∞ –æ–¥–Ω–æ–º warp –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ!**

---

## üî¥ –ü–†–û–ë–õ–ï–ú–ê #2: MEMORY COALESCING

### –ß—Ç–æ —Ç–∞–∫–æ–µ coalescing?

GPU —á–∏—Ç–∞–µ—Ç –ø–∞–º—è—Ç—å **–±–ª–æ–∫–∞–º–∏ –ø–æ 128 –±–∞–π—Ç** (–æ–±—ã—á–Ω–æ).

–ï—Å–ª–∏ —Å–æ—Å–µ–¥–Ω–∏–µ work items —á–∏—Ç–∞—é—Ç —Å–æ—Å–µ–¥–Ω–∏–µ –∞–¥—Ä–µ—Å–∞ ‚Üí **1 –æ–±—Ä–∞—â–µ–Ω–∏–µ –∫ –ø–∞–º—è—Ç–∏**
–ï—Å–ª–∏ —Å–æ—Å–µ–¥–Ω–∏–µ work items —á–∏—Ç–∞—é—Ç —Ä–∞–∑–Ω—ã–µ –∞–¥—Ä–µ—Å–∞ ‚Üí **–º–Ω–æ–≥–æ –æ–±—Ä–∞—â–µ–Ω–∏–π** ‚Üí –ú–ï–î–õ–ï–ù–ù–û

### –¢–µ–∫—É—â–µ–µ (–ù–ï–ü–†–ê–í–ò–õ–¨–ù–û):

```
Work 0: reads input[0 * 1.3–ú + 0]
Work 1: reads input[0 * 1.3–ú + 1]
Work 2: reads input[0 * 1.3–ú + 2]
```

**–ê–¥—Ä–µ—Å–∞**: 0, 1, 2, ... (–•–û–†–û–®–û –¥–ª—è —á—Ç–µ–Ω–∏—è, –Ω–æ...)

–ù–æ **–ø–æ—Ç–æ–º** —á–∏—Ç–∞–µ–º 5 —Å–æ—Å–µ–¥–Ω–∏—Ö –æ—Ç—Å—á—ë—Ç–æ–≤ –¥–ª—è –∏–Ω—Ç–µ—Ä–ø–æ–ª—è—Ü–∏–∏:
```
Work 0 —á–∏—Ç–∞–µ—Ç: idx[0], idx[1], idx[2], idx[3], idx[4] –∏–∑ antenna 0
Work 1 —á–∏—Ç–∞–µ—Ç: idx[0], idx[1], idx[2], idx[3], idx[4] –∏–∑ antenna 0
...
```

–í—Å–µ 256 work items —á–∏—Ç–∞—é—Ç **–æ–¥–∏–Ω –∏ —Ç–æ—Ç –∂–µ –±–ª–æ–∫ –ø–∞–º—è—Ç–∏** ‚Üí –∫—ç—à miss!

### –ü—Ä–∞–≤–∏–ª—å–Ω–æ–µ (–ü–û–ü–ï–†–ï–ß–ù–û–ï):

```
Work 0: reads input[sample_id * 256 + 0]  (antenna 0)
Work 1: reads input[sample_id * 256 + 1]  (antenna 1)
Work 2: reads input[sample_id * 256 + 2]  (antenna 2)
```

**–ê–¥—Ä–µ—Å–∞**: sample_id*256 + [0,1,2,...,255] (–ò–î–ï–ê–õ–¨–ù–´–ô COALESCING!)

–í—Å–µ 256 work items —á–∏—Ç–∞—é—Ç **—Ä–∞–∑–Ω—ã–µ –∞–Ω—Ç–µ–Ω—ã** –æ–¥–Ω–æ–≥–æ –æ—Ç—Å—á—ë—Ç–∞ ‚Üí **–≤—Å–µ –≤ –æ–¥–Ω–æ –æ–±—Ä–∞—â–µ–Ω–∏–µ!**

### –û—Ü–µ–Ω–∫–∞ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏:

```
–¢–µ–∫—É—â–µ–µ:   100 –æ–±—Ä–∞—â–µ–Ω–∏–π –∫ –ø–∞–º—è—Ç–∏ –Ω–∞ 256 –æ—Ç—Å—á—ë—Ç–æ–≤
           ‚Üí ~390 ns –Ω–∞ –æ–¥–∏–Ω float2 (–ø—Ä–∏ 400 –ì–ë/—Å)

–ü—Ä–∞–≤–∏–ª—å–Ω–æ–µ: 1 –æ–±—Ä–∞—â–µ–Ω–∏–µ –∫ –ø–∞–º—è—Ç–∏ –Ω–∞ 256 –æ—Ç—Å—á—ë—Ç–æ–≤
            ‚Üí ~4 ns –Ω–∞ –æ–¥–∏–Ω float2 (100x —É—Å–∫–æ—Ä–µ–Ω–∏–µ!)
```

---

## üî¥ –ü–†–û–ë–õ–ï–ú–ê #3: –ì–†–ê–ù–ò–ß–ù–´–ï –£–°–õ–û–í–ò–Ø

### –¢–µ–∫—É—â–∏–π –∫–æ–¥:

```c
if (idx0 >= 0 && idx0 < (int)num_samples) {
    float2 sample = input[base_offset + idx0];
    result.x = mad(coeff0, sample.x, result.x);
    result.y = mad(coeff0, sample.y, result.y);
}
```

**–ü—Ä–æ–±–ª–µ–º—ã**:
1. **–í–ª–æ–∂–µ–Ω–Ω—ã–µ if'—ã** (5 —É—Ä–æ–≤–Ω–µ–π!) ‚Üí Branch divergence
2. –ï—Å–ª–∏ –∏–Ω–¥–µ–∫—Å –≤–Ω–µ –≥—Ä–∞–Ω–∏—Ü ‚Üí **—á–∞—Å—Ç—å –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç–æ–≤ –æ–±–Ω—É–ª–µ–Ω—ã**
3. –≠—Ç–æ –º–æ–∂–µ—Ç –ø—Ä–∏–≤–µ—Å—Ç–∏ –∫ **—Ñ–∞–∑–æ–≤—ã–º –æ—à–∏–±–∫–∞–º** –Ω–∞ –∫—Ä–∞—è—Ö

### –ü—Ä–∞–≤–∏–ª—å–Ω—ã–π –ø–æ–¥—Ö–æ–¥:

```c
// –í–ê–†–ò–ê–ù–¢ 1: –ì–∞—Ä–∞–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å –≤–∞–ª–∏–¥–Ω–æ—Å—Ç—å –î–û —Ä–∞—Å—á—ë—Ç–æ–≤
int idx = reflect_boundary_symmetric(raw_idx, num_samples);
// –¢–µ–ø–µ—Ä—å idx –í–°–ï–ì–î–ê –≤–∞–ª–∏–¥–µ–Ω ‚Üí –Ω–µ—Ç if'–æ–≤ –≤ –∏–Ω—Ç–µ—Ä–ø–æ–ª—è—Ü–∏–∏
```

**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞**:
- –ù–µ—Ç –≤–ª–æ–∂–µ–Ω–Ω—ã—Ö if'–æ–≤
- –í—Å–µ work items –≤—ã–ø–æ–ª–Ω—è—é—Ç –æ–¥–∏–Ω–∞–∫–æ–≤—ã–π –∫–æ–¥
- –ù–µ—Ç branch divergence

### –ü—Ä–∞–≤–∏–ª—å–Ω–æ–µ –æ—Ç—Ä–∞–∂–µ–Ω–∏–µ:

```c
// –°–ò–ú–ú–ï–¢–†–ò–ß–ù–û–ï –æ—Ç—Ä–∞–∂–µ–Ω–∏–µ (–∑–µ—Ä–∫–∞–ª–æ –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ –≥—Ä–∞–Ω–∏—Ü)
inline int reflect_boundary_symmetric(int idx, const uint num_samples) {
    if (idx < 0) {
        idx = -(idx + 1);  // -1 ‚Üí 0, -2 ‚Üí 1, ...
    }
    
    int period = 2 * num_samples - 2;
    idx = idx % period;
    
    if (idx >= (int)num_samples) {
        idx = period - idx;
    }
    
    return idx;
}
```

**–ü—Ä–æ–≤–µ—Ä–∫–∞**:
```
sample_id=1300000, idx needs [1299998, 1299999, 1300000, -1, -2]
After reflect:
- 1299998 ‚Üí 1299998 ‚úì
- 1299999 ‚Üí 1299999 ‚úì
- 1300000 ‚Üí –æ—Ç—Ä–∞–∂–µ–Ω–∏–µ ‚Üí 1299999 (–∏–ª–∏ –∫–∞–∫ —É –≤–∞—Å?)
- -1 ‚Üí 0 ‚úì
- -2 ‚Üí 1 ‚úì
```

‚ùì **–í–û–ü–†–û–°**: –ö–∞–∫–æ–µ –æ—Ç—Ä–∞–∂–µ–Ω–∏–µ —Ç—Ä–µ–±—É–µ—Ç—Å—è –ø–æ –¢–ó?

---

## üî¥ –ü–†–û–ë–õ–ï–ú–ê #4: LOCAL MEMORY –ù–ï –ò–°–ü–û–õ–¨–ó–£–ï–¢–°–Ø

### –¢–µ–∫—É—â–µ–µ (–ù–ï–ü–†–ê–í–ò–õ–¨–ù–û):

```c
// –ö–∞–∂–¥—ã–π work item —á–∏—Ç–∞–µ—Ç –∏–∑ –≥–ª–æ–±–∞–ª—å–Ω–æ–π –ø–∞–º—è—Ç–∏ 5 —Ä–∞–∑
float coeff0 = lagrange_matrix[matrix_base + 0];  // ~100-400 ns
float coeff1 = lagrange_matrix[matrix_base + 1];  // ~100-400 ns
float coeff2 = lagrange_matrix[matrix_base + 2];  // ~100-400 ns
float coeff3 = lagrange_matrix[matrix_base + 3];  // ~100-400 ns
float coeff4 = lagrange_matrix[matrix_base + 4];  // ~100-400 ns
```

**–°—Ç–æ–∏–º–æ—Å—Ç—å**: 5 √ó 400 ns = 2000 ns (–ø—Ä–æ—Å—Ç–æ –Ω–∞ —á—Ç–µ–Ω–∏–µ –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç–æ–≤!)

### –ü—Ä–∞–≤–∏–ª—å–Ω–æ–µ (–° LOCAL MEMORY):

```c
// –í–°–ï 256 work items –∑–∞–≥—Ä—É–∂–∞—é—Ç –º–∞—Ç—Ä–∏—Ü—É –û–î–ò–ù –†–ê–ó –≤ –ª–æ–∫–∞–ª—å–Ω—É—é –ø–∞–º—è—Ç—å
__local float local_lagrange_coeffs[48 * 5];

for (uint i = local_id; i < 240; i += get_local_size(0)) {
    local_lagrange_coeffs[i] = lagrange_matrix[i];
}
barrier(CLK_LOCAL_MEM_FENCE);

// –¢–µ–ø–µ—Ä—å –∫–∞–∂–¥—ã–π work item —á–∏—Ç–∞–µ—Ç –∏–∑ –ª–æ–∫–∞–ª—å–Ω–æ–π –ø–∞–º—è—Ç–∏ (~1-3 ns)
float coeff0 = local_lagrange_coeffs[matrix_base + 0];  // ~2 ns
float coeff1 = local_lagrange_coeffs[matrix_base + 1];  // ~2 ns
...
```

**–≠–∫–æ–Ω–æ–º–∏—è**: 5 √ó (400 - 2) ns = ~2000 ns –Ω–∞ 1.3–ú –æ—Ç—Å—á—ë—Ç–æ–≤!

**–ò—Ç–æ–≥–æ**: 1.3–ú √ó 2000 ns = 2.6 —Å–µ–∫ —ç–∫–æ–Ω–æ–º–∏–∏ (!)

---

## üìä –ò–¢–û–ì–û–í–ê–Ø –¢–ê–ë–õ–ò–¶–ê –°–†–ê–í–ù–ï–ù–ò–Ø

| –ü–∞—Ä–∞–º–µ—Ç—Ä | –¢–µ–∫—É—â–µ–µ | –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ | –£—Å–∫–æ—Ä–µ–Ω–∏–µ |
|----------|---------|-----------------|-----------|
| Memory coalescing | ‚ùå –†–∞–∑—Ä—É—à–µ–Ω–∞ | ‚úÖ –ò–¥–µ–∞–ª—å–Ω–∞ | 10-100x |
| Local memory | ‚ùå –ù–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è | ‚úÖ –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è | 200x (–∫–æ—ç—Ñ—Ñ.) |
| Branch divergence | ‚ö†Ô∏è –ï—Å—Ç—å | ‚úÖ –ù–µ—Ç | 5-10x |
| Register usage | ‚úì –•–æ—Ä–æ—à–æ | ‚úì –•–æ—Ä–æ—à–æ | - |
| **–ò–¢–û–ì–û –£–°–ö–û–†–ï–ù–ò–ï** | - | - | **15-100x** |
| –û–∂–∏–¥–∞–µ–º–æ–µ –≤—Ä–µ–º—è | ~2-5 —Å–µ–∫ | ~100-300 –º—Å | **10-50x** |

---

## ‚úÖ –ß–¢–û –ù–£–ñ–ù–û –°–î–ï–õ–ê–¢–¨

### –®–∞–≥ 1: –ü–ï–†–ï–ü–ò–°–ê–¢–¨ –ê–†–•–ò–¢–ï–ö–¢–£–†–£ (–ö–†–ò–¢–ò–ß–ù–û!)

```c
// –í–ú–ï–°–¢–û:
uint beam_id = global_id / num_samples;
uint sample_id = global_id % num_samples;

// –ü–ò–®–ï–ú:
uint sample_id = global_id / num_beams;
uint beam_id = global_id % num_beams;
```

### –®–∞–≥ 2: –î–û–ë–ê–í–ò–¢–¨ LOCAL MEMORY

```c
__kernel void fractional_delay(
    ...,
    __local float* local_lagrange_coeffs
) {
    // –ó–∞–≥—Ä—É–∑–∏—Ç—å –º–∞—Ç—Ä–∏—Ü—É –æ–¥–∏–Ω —Ä–∞–∑
    for (uint i = local_id; i < 240; i += get_local_size(0)) {
        local_lagrange_coeffs[i] = lagrange_matrix[i];
    }
    barrier(CLK_LOCAL_MEM_FENCE);
    
    // –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∏–∑ –ª–æ–∫–∞–ª—å–Ω–æ–π –ø–∞–º—è—Ç–∏
}
```

### –®–∞–≥ 3: –ü–ï–†–ï–ü–ò–°–ê–¢–¨ –ì–†–ê–ù–ò–ß–ù–´–ï –£–°–õ–û–í–ò–Ø

```c
// –û—Ç—Ä–∞–∂–µ–Ω–∏–µ –î–û —Ä–∞—Å—á—ë—Ç–æ–≤, –ë–ï–ó if'–æ–≤ –≤–Ω—É—Ç—Ä–∏ –∏–Ω—Ç–µ—Ä–ø–æ–ª—è—Ü–∏–∏
int idx[5];
for (int k = 0; k < 5; k++) {
    idx[k] = reflect_boundary_symmetric(centre + k - 2, num_samples);
}

// –ò–Ω—Ç–µ—Ä–ø–æ–ª—è—Ü–∏—è –ë–ï–ó –ø—Ä–æ–≤–µ—Ä–æ–∫ –≥—Ä–∞–Ω–∏—Ü
for (int k = 0; k < 5; k++) {
    result += coeff[k] * input[idx[k]];  // –ü—Ä—è–º–∞—è —Ä–∞–±–æ—Ç–∞, –ë–ï–ó if
}
```

### –®–∞–≥ 4: –í–´–ë–†–ê–¢–¨ –ü–†–ê–í–ò–õ–¨–ù–´–ô –†–ê–ó–ú–ï–† WORK GROUP

**–í–∞—Ä–∏–∞–Ω—Ç A: 1D (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)**
```c
size_t work_group_size[1] = {256};  // –í—Å–µ 256 –∞–Ω—Ç–µ–Ω –≤ –æ–¥–Ω–æ–π –≥—Ä—É–ø–ø–µ
// Launch: [global: num_beams * num_samples, local: 256]
```

**–í–∞—Ä–∏–∞–Ω—Ç B: 2D (–∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–∞)**
```c
size_t work_group_size[2] = {256, 1};  // 256 –∞–Ω—Ç–µ–Ω √ó 1 –æ—Ç—Å—á—ë—Ç
// Launch: [global: {num_beams, num_samples}, local: {256, 1}]
```

---

## ü§î –í–û–ü–†–û–°–´ –î–õ–Ø –û–ë–°–£–ñ–î–ï–ù–ò–Ø

1. **–û—Ç—Ä–∞–∂–µ–Ω–∏–µ –≥—Ä–∞–Ω–∏—Ü**: –ù—É–∂–Ω–æ **—Å–∏–º–º–µ—Ç—Ä–∏—á–Ω–æ–µ** –∏–ª–∏ **–ø–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–æ–µ** –æ—Ç—Ä–∞–∂–µ–Ω–∏–µ?
   - –¢–µ–∫—É—â–∏–π –∫–æ–¥: `if (idx < 0) return -idx;` ‚Üí —ç—Ç–æ –∞—Å–∏–º–º–µ—Ç—Ä–∏—á–Ω–æ–µ
   - –û–±—ã—á–Ω–æ –Ω—É–∂–Ω–æ: —Å–∏–º–º–µ—Ç—Ä–∏—á–Ω–æ–µ –æ—Ç—Ä–∞–∂–µ–Ω–∏–µ

2. **–¢–æ—á–Ω–æ—Å—Ç—å**: –ù—É–∂–Ω–∞ –ª–∏ **–≤—ã—Å–æ–∫–∞—è —Ç–æ—á–Ω–æ—Å—Ç—å** –∏–ª–∏ **speed matters**?
   - –¢–µ–∫—É—â–∏–π `mad()` –º–æ–∂–µ—Ç –Ω–µ–º–Ω–æ–≥–æ –ø–æ—Ç–µ—Ä—è—Ç—å —Ç–æ—á–Ω–æ—Å—Ç—å
   - –ï—Å–ª–∏ –∫—Ä–∏—Ç–∏—á–Ω–∞ —Ç–æ—á–Ω–æ—Å—Ç—å ‚Üí –∏—Å–ø–æ–ª—å–∑—É–µ–º `result += coeff * sample`

3. **In-place –æ–±—Ä–∞–±–æ—Ç–∫–∞**: –ì–∞—Ä–∞–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω–æ –ª–∏ –º–æ–∂–Ω–æ –ø–µ—Ä–µ–∑–∞–ø–∏—Å—ã–≤–∞—Ç—å?
   - –ï—Å–ª–∏ —ç–ª–µ–º–µ–Ω—Ç —É–∂–µ –ø—Ä–æ—á–∏—Ç–∞–Ω ‚Üí –º–æ–∂–Ω–æ –±–µ–∑–æ–ø–∞—Å–Ω–æ –ø–µ—Ä–µ–∑–∞–ø–∏—Å–∞—Ç—å
   - –° –ø–æ–ø–µ—Ä–µ—á–Ω–æ–π –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–æ–π —ç—Ç–æ –Ω–µ –ø—Ä–æ–±–ª–µ–º–∞

4. **–†–∞–∑–º–µ—Ä work group**: –ï—Å—Ç—å –ª–∏ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è?
   - AMD GPU: –¥–æ 256-1024 work items –Ω–∞ group
   - NVIDIA GPU: –¥–æ 1024 work items –Ω–∞ group
   - 256 –æ–ø—Ç–∏–º–∞–ª—å–Ω–æ –¥–ª—è –æ–±–æ–∏—Ö

5. **Lagrange matrix —Ä–∞–∑–º–µ—Ä**: –í—Å–µ–≥–¥–∞ 48√ó5 –∏–ª–∏ –º–æ–∂–µ—Ç –±—ã—Ç—å –¥—Ä—É–≥–∏–º?
   - –ï—Å–ª–∏ –ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è ‚Üí –Ω—É–∂–Ω–æ –æ–±–æ–±—â–∏—Ç—å –∫–æ–¥

---

## üìù –†–ï–ö–û–ú–ï–ù–î–ê–¶–ò–Ø

**–ù–ï–ú–ï–î–õ–ï–ù–ù–û –ø–µ—Ä–µ–ø–∏—Å–∞—Ç—å –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—É!** –≠—Ç–æ –¥–∞—Å—Ç 10-50x —É—Å–∫–æ—Ä–µ–Ω–∏–µ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏.

–Ø –ø–æ–¥–≥–æ—Ç–æ–≤–∏–ª –¥–≤–∞ –≤–∞—Ä–∏–∞–Ω—Ç–∞ kernel'–∞:
1. **1D –≤–∞—Ä–∏–∞–Ω—Ç** (–ø—Ä–æ—â–µ, –±—ã—Å—Ç—Ä–µ–µ)
2. **2D –≤–∞—Ä–∏–∞–Ω—Ç** (–º–æ–∂–µ—Ç –±—ã—Ç—å –º–µ–¥–ª–µ–Ω–Ω–µ–µ, –Ω–æ –ø–æ–Ω—è—Ç–Ω–µ–µ)

–ö–∞–∫–æ–π –ø—Ä–µ–¥–ø–æ—á–∏—Ç–∞–µ—à—å? –ò –Ω—É–∂–Ω—ã –ª–∏ –µ—â—ë –∫–∞–∫–∏–µ-—Ç–æ —É—Ç–æ—á–Ω–µ–Ω–∏—è –ø–æ –¢–ó?
