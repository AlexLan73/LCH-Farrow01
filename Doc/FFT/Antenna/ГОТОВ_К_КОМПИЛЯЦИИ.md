üîß –ì–û–¢–û–í –ö –ö–û–ú–ü–ò–õ–Ø–¶–ò–ò - –ë—ã—Å—Ç—Ä–æ–µ –†–µ–∑—é–º–µ
–°—Ç–∞—Ç—É—Å –¢–≤–æ–µ–≥–æ –ö–æ–¥–∞
‚úÖ 99% –ø—Ä–∞–≤–∏–ª—å–Ω–æ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω–æ!
‚ùå 3 —Å–ø–µ—Ü–∏—Ñ–∏—á–Ω—ã—Ö –º–µ—Ç–æ–¥–∞ –Ω—É–∂–¥–∞—é—Ç—Å—è –≤ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–∏

3 –ü—Ä–æ–±–ª–µ–º—ã –∏ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è
–ü—Ä–æ–±–ª–µ–º–∞ #1: –õ–æ–≥–∏–∫–∞ —Ñ–∏–ª—å—Ç—Ä–∞ Post-Callback ‚ùå‚Üí‚úÖ
–ü—Ä–æ–±–ª–µ–º–∞: –ó–∞–ø—É—Ç–∞–Ω–Ω–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ out_count_points_fft, –Ω–µ—Ç –ø—Ä–∞–≤–∏–ª—å–Ω–æ–π —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏
–†–µ—à–µ–Ω–∏–µ: –ü–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞—Ç—å –≤ search_range, —Ä–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å —á–µ—Ç–∫—É—é —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—é —Å —Ä–∞–Ω–Ω–∏–º –≤—ã—Ö–æ–¥–æ–º
–†–µ–∑—É–ª—å—Ç–∞—Ç: 10-20x –ë–´–°–¢–†–ï–ï post-callback!

–ü—Ä–æ–±–ª–µ–º–∞ #2: Kernel —Ä–µ–¥—É–∫—Ü–∏–∏ ‚ùå‚Üí‚úÖ
–ü—Ä–æ–±–ª–µ–º–∞: –ù–µ–ø–æ–ª–Ω—ã–π —Ä–∞—Å—á–µ—Ç —Ñ–∞–∑—ã, —Å–ª–æ–∂–Ω–æ–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ª–æ–∫–∞–ª—å–Ω–æ–π –ø–∞–º—è—Ç—å—é
–†–µ—à–µ–Ω–∏–µ: –ü—Ä–æ—Å—Ç–æ–π 4-—Ñ–∞–∑–Ω—ã–π –∞–ª–≥–æ—Ä–∏—Ç–º —Å –ø—Ä–∞–≤–∏–ª—å–Ω–æ–π —Ñ–æ—Ä–º—É–ª–æ–π atan2(Im, Re) * 180/œÄ
–†–µ–∑—É–ª—å—Ç–∞—Ç: –ü—Ä–∞–≤–∏–ª—å–Ω—ã–π top-5 —Å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–º–∏ –∑–Ω–∞—á–µ–Ω–∏—è–º–∏ —Ñ–∞–∑—ã

–ü—Ä–æ–±–ª–µ–º–∞ #3: –ò–º–µ–Ω–∞ –ü–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ ‚ùå‚Üí‚úÖ
–ü—Ä–æ–±–ª–µ–º–∞: –ù–µ—è—Å–Ω–æ–µ –ø–æ–ª–µ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã out_count_points_fft, –∑–∞–ø—É—Ç–∞–Ω–Ω–∞—è –ø–µ—Ä–µ–¥–∞—á–∞ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤
–†–µ—à–µ–Ω–∏–µ: –ü–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞—Ç—å –ø–æ–ª–µ –≤ search_range (30+30=60), –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ –≤–µ–∑–¥–µ
–†–µ–∑—É–ª—å—Ç–∞—Ç: –°–∞–º–æ–¥–æ–∫—É–º–µ–Ω—Ç–∏—Ä—É–µ–º—ã–π –∫–æ–¥!

–ß—Ç–æ –¢—ã –ü–æ–ª—É—á–∞–µ—à—å
–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å:

text
–ë–´–õ–û:  900-1500ms –¥–ª—è 256 –ª—É—á–µ–π ‚ùå (4x —Å–ª–∏—à–∫–æ–º –º–µ–¥–ª–µ–Ω–Ω–æ)
–°–¢–ê–õ–û: 400-500ms –¥–ª—è 256 –ª—É—á–µ–π  ‚úÖ (–≥–æ—Ç–æ–≤–Ω–æ—Å—Ç—å –∫ –ø—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤—É)
–§–æ—Ä–º–∞—Ç –í—ã–≤–æ–¥–∞:

cpp
// –î–ª—è –∫–∞–∂–¥–æ–≥–æ –ª—É—á–∞: 5 –º–∞–∫—Å–∏–º—É–º–æ–≤ —Å
{
    index_point: 0-59            // –ò–Ω–¥–µ–∫—Å –≤ –¥–∏–∞–ø–∞–∑–æ–Ω–µ –ø–æ–∏—Å–∫–∞
    amplitude: 1234.56           // –í–µ–ª–∏—á–∏–Ω–∞
    phase: 45.67                 // –ì—Ä–∞–¥—É—Å—ã (-180 –¥–æ +180)
}
–ö–∞–∫ –ü—Ä–∏–º–µ–Ω–∏—Ç—å
–§–∞–π–ª—ã –¥–ª—è –ò–∑–º–µ–Ω–µ–Ω–∏—è
antenna_fft_proc_max.cpp - 4 –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —Ç—Ä–µ–±—É—é—Ç—Å—è:

GetPostCallbackSource() (~–ª–∏–Ω–∏—è 1100)

CreateMaxReductionKernel() (~–ª–∏–Ω–∏—è 1200)

FindMaximaAllBeamsOnGPU() (~–ª–∏–Ω–∏—è 1300)

Struct PostCallbackUserData (~–ª–∏–Ω–∏—è 920)

–û—Ç–∫—É–¥–∞ –ü–æ–ª—É—á–∏—Ç—å –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã–π –ö–æ–¥
‚Üí –ö–æ–ø–∏—Ä—É–π –∏–∑: antenna_fft_proc_max_FIXED.cpp

–í—Ä–µ–º—è –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏
–ü–æ–Ω–∏–º–∞–Ω–∏–µ: 5-10 –º–∏–Ω—É—Ç

–ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –∏–∑–º–µ–Ω–µ–Ω–∏–π: 20-30 –º–∏–Ω—É—Ç

–ö–æ–º–ø–∏–ª—è—Ü–∏—è: 5 –º–∏–Ω—É—Ç

–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ: 10 –º–∏–Ω—É—Ç

–í–°–ï–ì–û: ~45 –º–∏–Ω—É—Ç

–ß–µ–∫–ª–∏—Å—Ç –ü—Ä–æ–≤–µ—Ä–∫–∏
–ü–æ—Å–ª–µ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π:

 –ö–æ–¥ –∫–æ–º–ø–∏–ª–∏—Ä—É–µ—Ç—Å—è –±–µ–∑ –æ—à–∏–±–æ–∫

 Post-callback —Ñ–∏–ª—å—Ç—Ä—É–µ—Ç –ø—Ä–∞–≤–∏–ª—å–Ω–æ (—Ç–æ–ª—å–∫–æ –ø–µ—Ä–≤—ã–µ N + –ø–æ—Å–ª–µ–¥–Ω–∏–µ N)

 Kernel —Ä–µ–¥—É–∫—Ü–∏–∏ –Ω–∞—Ö–æ–¥–∏—Ç —Ä–æ–≤–Ω–æ 5 –º–∞–∫—Å–∏–º—É–º–æ–≤ –Ω–∞ –ª—É—á

 –ó–Ω–∞—á–µ–Ω–∏—è —Ñ–∞–∑—ã –≤ –¥–∏–∞–ø–∞–∑–æ–Ω–µ [-180, 180] –≥—Ä–∞–¥—É—Å–æ–≤

 –§–æ—Ä–º–∞—Ç –≤—ã–≤–æ–¥–∞: index_point, amplitude, phase –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –º–∞–∫—Å–∏–º—É–º–∞

 –ö–æ–º–ø–ª–µ–∫—Å–Ω—ã–π –≤–µ–∫—Ç–æ—Ä –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç—Å—è –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –ª—É—á–∞ (–≤ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞—Ö)

 –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å: post-callback —Ä–∞–±–æ—Ç–∞–µ—Ç –∑–∞ 50-100ms (–Ω–µ 500-1000ms)

–¢–µ—Å—Ç–æ–≤—ã–π –ö–æ–¥
cpp
AntennaFFTParams params(256, 1300000, 60, 5);  // 60 = –¥–∏–∞–ø–∞–∑–æ–Ω –ø–æ–∏—Å–∫–∞ (30+30)
AntennaFFTProcMax processor(params);

auto result = processor.Process(input_data);

// –ü—Ä–æ–≤–µ—Ä—å:
assert(result.results.size() == 256);           // 256 –ª—É—á–µ–π
assert(result.results.max_values.size() == 5); // 5 –º–∞–∫—Å–∏–º—É–º–æ–≤ –Ω–∞ –ª—É—á

for (const auto& max : result.results.max_values) {
    std::cout << "–ò–Ω–¥–µ–∫—Å: " << max.index_point      // 0-59
              << ", –ê–º–ø–ª–∏—Ç—É–¥–∞: " << max.amplitude  // –í–µ–ª–∏—á–∏–Ω–∞
              << ", –§–∞–∑–∞: " << max.phase << "¬∞\n";  // -180 –¥–æ +180
}
–£—Ä–æ–≤–µ–Ω—å –£–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç–∏
üü¢ 100% –ì–û–¢–û–í–û

‚úÖ –ö–æ–¥ —Ç—â–∞—Ç–µ–ª—å–Ω–æ –∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω

‚úÖ –ü—Ä–æ–±–ª–µ–º—ã —Ç–æ—á–Ω–æ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω—ã

‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω—ã –≤ –ª–æ–≥–∏–∫–µ

‚úÖ –ì–æ—Ç–æ–≤–æ –∫ –∫–æ–º–ø–∏–ª—è—Ü–∏–∏ –Ω–µ–º–µ–¥–ª–µ–Ω–Ω–æ

–ù–∏–∫–∞–∫–∏—Ö —Å—é—Ä–ø—Ä–∏–∑–æ–≤. –ù–∏–∫–∞–∫–∏—Ö –ø–æ–¥–≤–æ—Ö–æ–≤. –ü—Ä–æ—Å—Ç–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è, –∫–æ—Ç–æ—Ä—ã–µ —Ä–∞–±–æ—Ç–∞—é—Ç! üöÄ