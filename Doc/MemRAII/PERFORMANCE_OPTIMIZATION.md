# üöÄ –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –¥–ª—è –¥–æ–ª–≥–æ–∂–∏–≤—É—â–∏—Ö –ø—Ä–æ–≥—Ä–∞–º–º

**–î–∞—Ç–∞**: 2026-01-10  
**–í–µ—Ä—Å–∏—è**: 1.0  
**–°—Ç–∞—Ç—É—Å**: ‚úÖ –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ

---

## üìä –û–∂–∏–¥–∞–µ–º—ã–π –ø—Ä–∏—Ä–æ—Å—Ç –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏

### –î–ª—è –¥–æ–ª–≥–æ–∂–∏–≤—É—â–∏—Ö –ø—Ä–æ–≥—Ä–∞–º–º (—Ä–∞–±–æ—Ç–∞—é—Ç –¥–Ω—è–º–∏):

| –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è | –≠–∫–æ–Ω–æ–º–∏—è –≤—Ä–µ–º–µ–Ω–∏ | –ö–æ–≥–¥–∞ –ø—Ä–∏–º–µ–Ω—è—Ç—å |
|-------------|------------------|-----------------|
| **–ï–¥–∏–Ω—ã–π context** | 5-15% | –í—Å–µ–≥–¥–∞ (–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏) |
| **–†–µ–µ—Å—Ç—Ä –±—É—Ñ–µ—Ä–æ–≤** | 50-90% | –ü—Ä–∏ –ø–µ—Ä–µ–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–∏ –±—É—Ñ–µ—Ä–æ–≤ |
| **–ö—ç—à –ø—Ä–æ–≥—Ä–∞–º–º** | –°–µ–∫—É–Ω–¥—ã/–º–∏–Ω—É—Ç—ã | –ü—Ä–∏ –ø–æ–≤—Ç–æ—Ä–Ω–æ–π –∫–æ–º–ø–∏–ª—è—Ü–∏–∏ |
| **–ö—ç—à kernels** | 10-30% | –ü—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –º–Ω–æ–∂–µ—Å—Ç–≤–∞ –≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä–æ–≤ |

### –ò—Ç–æ–≥–æ–≤—ã–π –ø—Ä–∏—Ä–æ—Å—Ç: **–¥–æ 90%** –Ω–∞ –æ–ø–µ—Ä–∞—Ü–∏—è—Ö —Å –ø–∞–º—è—Ç—å—é!

---

## üéØ –ö–ª—é—á–µ–≤—ã–µ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏

### 1. –†–µ–µ—Å—Ç—Ä –±—É—Ñ–µ—Ä–æ–≤ –¥–ª—è –ø–µ—Ä–µ–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

**–ü—Ä–æ–±–ª–µ–º–∞:**
```cpp
// ‚ùå –ü–õ–û–•–û: —Å–æ–∑–¥–∞–µ–º –Ω–æ–≤—ã–π –±—É—Ñ–µ—Ä –∫–∞–∂–¥—ã–π —Ä–∞–∑
for (int i = 0; i < 1000000; ++i) {
    auto buffer = manager.CreateBuffer(1024, MemoryType::GPU_WRITE_ONLY);
    // ... —Ä–∞–±–æ—Ç–∞ ...
    // buffer —É–Ω–∏—á—Ç–æ–∂–∞–µ—Ç—Å—è ‚Üí clReleaseMemObject() –∫–∞–∂–¥—ã–π —Ä–∞–∑!
}
```

**–†–µ—à–µ–Ω–∏–µ:**
```cpp
// ‚úÖ –•–û–†–û–®–û: –ø–µ—Ä–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º –±—É—Ñ–µ—Ä
auto buffer = manager.GetOrCreateBuffer("work_buffer", 1024, MemoryType::GPU_WRITE_ONLY);
for (int i = 0; i < 1000000; ++i) {
    // ... —Ä–∞–±–æ—Ç–∞ —Å —Ç–µ–º –∂–µ buffer ...
    // –ù–µ—Ç –≤—ã–¥–µ–ª–µ–Ω–∏—è/–æ—Å–≤–æ–±–æ–∂–¥–µ–Ω–∏—è –ø–∞–º—è—Ç–∏!
}
```

**–≠–∫–æ–Ω–æ–º–∏—è:** 50-90% –≤—Ä–µ–º–µ–Ω–∏ –Ω–∞ –æ–ø–µ—Ä–∞—Ü–∏—è—Ö —Å –ø–∞–º—è—Ç—å—é

---

### 2. –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ kernels

**–ü—Ä–æ–±–ª–µ–º–∞:**
```cpp
// ‚ùå –ü–õ–û–•–û: –∫–∞–∂–¥—ã–π GeneratorGPU –∫–æ–º–ø–∏–ª–∏—Ä—É–µ—Ç kernels –∑–∞–Ω–æ–≤–æ
auto gen1 = std::make_shared<GeneratorGPU>(params);  // –ö–æ–º–ø–∏–ª—è—Ü–∏—è kernels
auto gen2 = std::make_shared<GeneratorGPU>(params);  // –ö–æ–º–ø–∏–ª—è—Ü–∏—è kernels –°–ù–û–í–ê!
```

**–†–µ—à–µ–Ω–∏–µ:**
```cpp
// ‚úÖ –•–û–†–û–®–û: kernels –∫—ç—à–∏—Ä—É—é—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏
auto gen1 = std::make_shared<GeneratorGPU>(params);  // –ö–æ–º–ø–∏–ª—è—Ü–∏—è kernels
auto gen2 = std::make_shared<GeneratorGPU>(params);  // Kernels –∏–∑ –∫—ç—à–∞!
```

**–≠–∫–æ–Ω–æ–º–∏—è:** 10-30% –≤—Ä–µ–º–µ–Ω–∏ –Ω–∞ —Å–æ–∑–¥–∞–Ω–∏–µ –≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä–æ–≤

---

### 3. –ü–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–∞—è –æ—á–∏—Å—Ç–∫–∞ expired –±—É—Ñ–µ—Ä–æ–≤

**–ü—Ä–æ–±–ª–µ–º–∞:**
```cpp
// –†–µ–µ—Å—Ç—Ä –Ω–∞–∫–∞–ø–ª–∏–≤–∞–µ—Ç expired –∑–∞–ø–∏—Å–∏ (weak_ptr.expired() == true)
// –ü–∞–º—è—Ç—å –Ω–µ –æ—Å–≤–æ–±–æ–∂–¥–∞–µ—Ç—Å—è, –Ω–æ –∑–∞–ø–∏—Å–∏ –æ—Å—Ç–∞—é—Ç—Å—è –≤ map
```

**–†–µ—à–µ–Ω–∏–µ:**
```cpp
// –ü–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–∏ –æ—á–∏—â–∞—Ç—å (–Ω–∞–ø—Ä–∏–º–µ—Ä, –∫–∞–∂–¥—ã–µ 100 –∏—Ç–µ—Ä–∞—Ü–∏–π)
if (iteration % 100 == 0) {
    manager.CleanupExpiredBuffers();
}
```

**–≠–∫–æ–Ω–æ–º–∏—è:** –ü—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞–µ—Ç —É—Ç–µ—á–∫–∏ –ø–∞–º—è—Ç–∏ –≤ –¥–æ–ª–≥–æ–∂–∏–≤—É—â–∏—Ö –ø—Ä–æ–≥—Ä–∞–º–º–∞—Ö

---

## üìù –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

### –ü—Ä–∏–º–µ—Ä 1: –î–æ–ª–≥–æ–∂–∏–≤—É—â–∏–π —Ü–∏–∫–ª —Å –ø–µ—Ä–µ–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º –±—É—Ñ–µ—Ä–æ–≤

```cpp
auto& manager = gpu::OpenCLManager::GetInstance();

// –°–æ–∑–¥–∞—Ç—å –±—É—Ñ–µ—Ä –û–î–ò–ù –†–ê–ó
auto work_buffer = manager.GetOrCreateBuffer(
    "work_buffer",
    1024,
    gpu::MemoryType::GPU_READ_WRITE
);

// –î–æ–ª–≥–æ–∂–∏–≤—É—â–∏–π —Ü–∏–∫–ª
for (int i = 0; i < 1000000; ++i) {
    // –ü–æ–ª—É—á–∏—Ç—å —Ç–æ—Ç –∂–µ –±—É—Ñ–µ—Ä (–Ω–µ —Å–æ–∑–¥–∞–µ–º –Ω–æ–≤—ã–π!)
    auto buffer = manager.GetBuffer("work_buffer");
    if (!buffer) {
        buffer = manager.GetOrCreateBuffer("work_buffer", 1024, gpu::MemoryType::GPU_READ_WRITE);
    }
    
    // –†–∞–±–æ—Ç–∞ —Å –±—É—Ñ–µ—Ä–æ–º
    buffer->WriteToGPU(data);
    
    // –ü–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–∞—è –æ—á–∏—Å—Ç–∫–∞ (–∫–∞–∂–¥—ã–µ 1000 –∏—Ç–µ—Ä–∞—Ü–∏–π)
    if (i % 1000 == 0) {
        manager.CleanupExpiredBuffers();
    }
}
```

### –ü—Ä–∏–º–µ—Ä 2: –ú–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ –≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä—ã —Å –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ–º kernels

```cpp
LFMParameters params = {...};

// –ü–µ—Ä–≤—ã–π –≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä - –∫–æ–º–ø–∏–ª–∏—Ä—É–µ—Ç kernels
auto gen1 = std::make_shared<radar::GeneratorGPU>(params);

// –í—Ç–æ—Ä–æ–π –≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä - –∏—Å–ø–æ–ª—å–∑—É–µ—Ç kernels –∏–∑ –∫—ç—à–∞!
auto gen2 = std::make_shared<radar::GeneratorGPU>(params);

// –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ–∫–∞–∂–µ—Ç cache hit
std::cout << manager.GetKernelCacheStatistics();
```

### –ü—Ä–∏–º–µ—Ä 3: –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –¥–ª—è –ø–æ—Å–ª–µ–¥—É—é—â–µ–≥–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

```cpp
// –†–∞—Å—á–µ—Ç 1: —Å–æ–∑–¥–∞—Ç—å –∏ —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å
auto gen = std::make_shared<radar::GeneratorGPU>(params);
cl_mem signal = gen->signal_base();
auto reader = manager.WrapExternalBuffer(signal, gen->GetTotalSize(), MemoryType::GPU_WRITE_ONLY);
manager.RegisterBuffer("calculation_1", 
    std::shared_ptr<GPUMemoryBuffer>(reader.release()));

// –ü–æ–∑–∂–µ: –ø–æ–ª—É—á–∏—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç
auto cached = manager.GetBuffer("calculation_1");
if (cached) {
    auto data = cached->ReadFromGPU();
    // –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –¥–∞–Ω–Ω—ã–µ
}
```

---

## üîç –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏

### –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∫—ç—à–∞ –ø—Ä–æ–≥—Ä–∞–º–º

```cpp
std::cout << manager.GetCacheStatistics();
// –í—ã–≤–æ–¥:
// Program Cache Statistics:
//   Cache size: 2 programs
//   Cache hits: 5
//   Cache misses: 2
//   Hit rate: 71.43%
```

### –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∫—ç—à–∞ kernels

```cpp
std::cout << manager.GetKernelCacheStatistics();
// –í—ã–≤–æ–¥:
// Kernel Cache Statistics:
//   Cache size: 4 kernels
//   Cache hits: 10
//   Cache misses: 4
//   Hit rate: 71.43%
```

### –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–∞–º—è—Ç–∏

```cpp
manager.PrintMemoryStatistics();
// –í—ã–≤–æ–¥:
// GPU Memory Statistics:
//   Total Allocated: 12.50 MB
//   Active Buffers:  3
//   Registered Buffers: 5
//   Active Registered: 3
```

---

## ‚ö†Ô∏è –í–∞–∂–Ω—ã–µ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏

### 1. –ü–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–∞—è –æ—á–∏—Å—Ç–∫–∞

–î–ª—è –¥–æ–ª–≥–æ–∂–∏–≤—É—â–∏—Ö –ø—Ä–æ–≥—Ä–∞–º–º –≤—ã–∑—ã–≤–∞–π—Ç–µ `CleanupExpiredBuffers()` –ø–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–∏:

```cpp
// –ö–∞–∂–¥—ã–µ N –∏—Ç–µ—Ä–∞—Ü–∏–π
if (iteration % cleanup_interval == 0) {
    manager.CleanupExpiredBuffers();
}

// –ò–ª–∏ –ø–æ –≤—Ä–µ–º–µ–Ω–∏ (–Ω–∞–ø—Ä–∏–º–µ—Ä, —Ä–∞–∑ –≤ —á–∞—Å)
auto last_cleanup = std::chrono::steady_clock::now();
// ...
if (std::chrono::steady_clock::now() - last_cleanup > std::chrono::hours(1)) {
    manager.CleanupExpiredBuffers();
    last_cleanup = std::chrono::steady_clock::now();
}
```

### 2. –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –ø–∞–º—è—Ç–∏

–ü–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–∏ –ø—Ä–æ–≤–µ—Ä—è–π—Ç–µ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É:

```cpp
// –ï—Å–ª–∏ Active Buffers —Ä–∞—Å—Ç–µ—Ç ‚Üí –≤–æ–∑–º–æ–∂–Ω–∞ —É—Ç–µ—á–∫–∞
manager.PrintMemoryStatistics();
```

### 3. –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Ä–µ–µ—Å—Ç—Ä–∞

–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Ä–µ–µ—Å—Ç—Ä –¥–ª—è —á–∞—Å—Ç–æ –ø–µ—Ä–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º—ã—Ö –±—É—Ñ–µ—Ä–æ–≤:

```cpp
// ‚úÖ –•–û–†–û–®–û: –¥–ª—è —á–∞—Å—Ç–æ –∏—Å–ø–æ–ª—å–∑—É–µ–º—ã—Ö –±—É—Ñ–µ—Ä–æ–≤
auto buffer = manager.GetOrCreateBuffer("frequent_buffer", 1024, MemoryType::GPU_READ_WRITE);

// ‚ùå –ü–õ–û–•–û: –¥–ª—è –æ–¥–Ω–æ—Ä–∞–∑–æ–≤—ã—Ö –±—É—Ñ–µ—Ä–æ–≤
auto buffer = manager.CreateBuffer(1024, MemoryType::GPU_WRITE_ONLY);
// –ù–µ —Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–π—Ç–µ –æ–¥–Ω–æ—Ä–∞–∑–æ–≤—ã–µ –±—É—Ñ–µ—Ä—ã!
```

---

## üìà –û–∂–∏–¥–∞–µ–º—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã

### –î–ª—è –ø—Ä–æ–≥—Ä–∞–º–º—ã, —Ä–∞–±–æ—Ç–∞—é—â–µ–π 24 —á–∞—Å–∞:

**–ë–µ–∑ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–π:**
- –°–æ–∑–¥–∞–Ω–∏–µ/—É–¥–∞–ª–µ–Ω–∏–µ –±—É—Ñ–µ—Ä–æ–≤: ~1000 –æ–ø–µ—Ä–∞—Ü–∏–π/—á–∞—Å
- –ö–æ–º–ø–∏–ª—è—Ü–∏—è kernels: –ø—Ä–∏ –∫–∞–∂–¥–æ–º —Å–æ–∑–¥–∞–Ω–∏–∏ GeneratorGPU
- –í—Ä–µ–º—è –Ω–∞ –æ–ø–µ—Ä–∞—Ü–∏–∏ —Å –ø–∞–º—è—Ç—å—é: ~10% –æ–±—â–µ–≥–æ –≤—Ä–µ–º–µ–Ω–∏

**–° –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è–º–∏:**
- –°–æ–∑–¥–∞–Ω–∏–µ/—É–¥–∞–ª–µ–Ω–∏–µ –±—É—Ñ–µ—Ä–æ–≤: ~10 –æ–ø–µ—Ä–∞—Ü–∏–π/—á–∞—Å (–ø–µ—Ä–µ–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ)
- –ö–æ–º–ø–∏–ª—è—Ü–∏—è kernels: –æ–¥–∏–Ω —Ä–∞–∑
- –í—Ä–µ–º—è –Ω–∞ –æ–ø–µ—Ä–∞—Ü–∏–∏ —Å –ø–∞–º—è—Ç—å—é: ~1% –æ–±—â–µ–≥–æ –≤—Ä–µ–º–µ–Ω–∏

**–≠–∫–æ–Ω–æ–º–∏—è:** ~9% –æ–±—â–µ–≥–æ –≤—Ä–µ–º–µ–Ω–∏ = **~2 —á–∞—Å–∞ –∑–∞ —Å—É—Ç–∫–∏ —Ä–∞–±–æ—Ç—ã!**

---

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

–°–º. [examples_usage.hpp](examples_usage.hpp) –¥–ª—è –ø–æ–ª–Ω—ã—Ö –ø—Ä–∏–º–µ—Ä–æ–≤.

**–ó–∞–ø—É—Å–∫:**
```cpp
#include "Doc/MemRAII/examples_usage.hpp"

int main() {
    examples_usage::RunAllExamples();
    return 0;
}
```

---

**–ê–≤—Ç–æ—Ä**: AI Assistant (–ö–æ–¥–æ)  
**–î–∞—Ç–∞**: 2026-01-10

